# CVE-2019-3980

This repo was created to utilize the Nessus POC with a custom C# executable to run commands on a remote host and get the output of the command.

The python file is used to start a web server, execute the exploit, and then get the results over the web server.
The C# exe is uploaded through the exploit to the target. 
When executed on thte target calls back to the IP/Port specificed to get the command to run (path is/cmd) as well as to send the output to the same webserver.
Sending the output is done through a GET request that will generate a 404, but thats fine we just want the base64 data.

Similiar to how C2's operate, but with no encryption on anything. Also one runs once. Just the concept of the C2 communication is used.


C# exe has two variable that need updated:
string ip = "10.8.0.3";
string port = "8000";

--if port is updated, python script needs to be updated as well, variable to server the HTTP server is below in python script
PORT = 8000 

wherever script is launched from needs to contain the file uploaded and well as file called "cmd" which contains the windows commands you want to run.

To use:
Update variables
compile c#
run python script:

python dameware-poc.py -t target_ip -e executable_to_upload


Example below runs the net users command on the remote host
<br />
![Alt text](/dameware-poc1.png?raw=true&sanitize=true)
<br />
![Alt text](/dameware-poc2.png?raw=true&sanitize=true)
